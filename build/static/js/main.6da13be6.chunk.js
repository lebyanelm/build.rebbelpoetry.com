(this["webpackJsonprebbelpoetry.com"]=this["webpackJsonprebbelpoetry.com"]||[]).push([[0],{11:function(e,t,n){e.exports={PoemPageContainer:"PoemPage_PoemPageContainer__1CarM",PoemContents:"PoemPage_PoemContents__371ti",PoemSplitSides:"PoemPage_PoemSplitSides__3WBGw",PoemTextContainer:"PoemPage_PoemTextContainer__1JETF","is-guide":"PoemPage_is-guide__1x6C7",AnnotationsContainer:"PoemPage_AnnotationsContainer__Fzloh",SideButtons:"PoemPage_SideButtons__ugz1G",Eye:"PoemPage_Eye__3WqdT",Heart:"PoemPage_Heart__CcMDg",Bookmark:"PoemPage_Bookmark__2Sv34",PoemInformation:"PoemPage_PoemInformation__dnvQ3",PoemTags:"PoemPage_PoemTags__dFrKg",PoemActions:"PoemPage_PoemActions__3AxBr",CommentsSection:"PoemPage_CommentsSection__3FB5Z",CommentsSectionHeader:"PoemPage_CommentsSectionHeader__3L4d2",Name:"PoemPage_Name__oRO03"}},128:function(e,t){},15:function(e,t,n){e.exports={ProfilePage:"PoetProfile_ProfilePage__3EHfO",PageContents:"PoetProfile_PageContents__r-u8b",ProfileAvatar:"PoetProfile_ProfileAvatar__2wH_s",ProfileName:"PoetProfile_ProfileName__pBmrO",Name:"PoetProfile_Name__3iNLf",ProfileBiography:"PoetProfile_ProfileBiography__2A4pG",ProfileHeaderButtons:"PoetProfile_ProfileHeaderButtons__dhG6E",ProfileStats:"PoetProfile_ProfileStats__3S3gE",PoetProfileContents:"PoetProfile_PoetProfileContents__J1aos"}},157:function(e,t,n){},158:function(e,t,n){},159:function(e,t,n){},16:function(e,t,n){e.exports={FooterContainer:"Footer_FooterContainer__3om6w",Footer:"Footer_Footer__37hEc",BrandName:"Footer_BrandName__3Ln1q",Legal:"Footer_Legal__1pCYr",LeftSection:"Footer_LeftSection__cesUv",SectionName:"Footer_SectionName__21QzB",Attribution:"Footer_Attribution__12EnI"}},161:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),s=n(43),i=n.n(s),c=(n(79),n.p+"static/media/logo.6597611f.svg"),r=n(31),l=n.n(r),d=n(9),u=n.n(d),j=n(6),b=n(3),m=n(2),h=n(0),f=a.a.createContext({}),O=function(e){var t=e.children,n=a.a.useState(),o=Object(m.a)(n,2),s=o[0],i=o[1];return Object(h.jsx)(f.Provider,{value:{userSession:s,setUserSession:i},children:t})},x=function(){return a.a.useContext(f)},p=a.a.createContext({}),_=function(e){var t=e.children,n=a.a.useState({state:!1,handler:function(){return null}}),o=Object(m.a)(n,2),s=o[0],i=o[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"backlight",style:{display:s.state?"block":"none"},onClick:function(){i({state:!1,handler:function(){return null}}),s.handler()}}),Object(h.jsx)(p.Provider,{value:{isBacklightVisible:s,setIsBacklightVisible:i},children:t})]})},g=function(e){var t=e.userSession,n=e.location,o=a.a.useState(!1),s=Object(m.a)(o,2),i=s[0],c=s[1],r=a.a.useContext(p).setIsBacklightVisible,l=function(){c(!i),r({state:!i,handler:function(){c(!1)}})};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"dropdown-options-backlight"}),Object(h.jsx)("div",{className:"clickable",children:Object(h.jsxs)("div",{className:["navigation-item dropdown flex","/sign_in"===n.pathname||"/sign_up"===n.pathname?"active":"inactive"].join(" "),children:[Object(h.jsxs)("section",{onClick:function(){return l()},children:[Object(h.jsx)("div",{className:"avatar small-avatar",style:{marginRight:"5px",backgroundImage:"url(".concat(t.display_photo,")")}}),Object(h.jsx)("span",{children:null===t||void 0===t?void 0:t.display_name}),Object(h.jsx)(u.a,{style:{marginLeft:"5px",transform:"translateY(2px)"},name:"chevron-down"})]}),Object(h.jsxs)("div",{className:"dropdown-options",style:{display:i?"block":"none"},children:[Object(h.jsx)("section",{children:Object(h.jsxs)("span",{to:"/poet/me",children:["Signed in as"," ",Object(h.jsxs)("b",{children:[null===t||void 0===t?void 0:t.display_name," (",null===t||void 0===t?void 0:t.username,")"]})]})}),Object(h.jsxs)("section",{children:[Object(h.jsx)(b.b,{to:["/rebbels/@",null===t||void 0===t?void 0:t.username].join(""),children:"Your Profile"}),Object(h.jsx)(b.b,{to:"/collaborations",children:"Your Collaborations and Features"}),Object(h.jsx)(b.b,{to:"/your_drafts",children:"Your Unpublished Drafts"})]}),Object(h.jsxs)("section",{children:[Object(h.jsx)(b.b,{className:"",to:"/edit_profile",children:"Edit your profile"}),Object(h.jsx)(b.b,{className:"danger",to:"/sign_out",children:"Sign out"})]})]})]})})]})};g.defaultProps={};var P=g,v=function(){var e=Object(j.h)(),t=x().userSession;return Object(h.jsxs)("div",{className:l.a.HeaderContainer,children:[Object(h.jsxs)("a",{href:"https://patreon.com/@rebbelpoetry",target:"_blank",rel:"noreferrer",className:l.a.Banner,children:["We need your support to keep the site functional and available \u2014 Become a contributor",Object(h.jsx)(u.a,{name:"arrow-forward"})]}),Object(h.jsxs)("div",{className:l.a.Header,children:[Object(h.jsx)(b.b,{to:"/",className:l.a.HeaderBrandLogo,children:Object(h.jsx)("img",{src:c,alt:""})}),Object(h.jsxs)("section",{children:[t&&Object(h.jsx)(b.b,{to:"/new_poem",children:Object(h.jsx)("div",{className:["navigation-item","/new_poem"===e.pathname?"active":"inactive"].join(" "),children:"Publish New"})}),Object(h.jsx)(b.b,{to:"/discover",children:Object(h.jsx)("div",{className:["navigation-item","/discover"===e.pathname?"active":"inactive"].join(" "),children:"Discover"})}),Object(h.jsx)(b.b,{to:"/rebbels",children:Object(h.jsx)("div",{className:["navigation-item",e.pathname.includes("/rebbels")?"active":"inactive"].join(" "),children:"Rebbel Poets"})}),t&&Object(h.jsx)(b.b,{to:"/your_drafts",children:Object(h.jsx)("div",{className:["navigation-item","/your_drafts"===e.pathname?"active":"inactive"].join(" "),children:"Your Drafts"})}),Object(h.jsx)(b.b,{to:"/feeling_lucky",children:Object(h.jsx)("div",{className:["navigation-item","/feeling_lucky"===e.pathname?"active":"inactive"].join(" "),children:"Feeling Lucky"})}),Object(h.jsx)(b.b,{to:"/search",children:Object(h.jsx)("div",{className:["navigation-item","/search"===e.pathname?"active":"inactive"].join(" "),children:"Search"})})]}),Object(h.jsx)("div",{className:"flex-space"}),Object(h.jsxs)("section",{children:[!t&&Object(h.jsx)(b.b,{to:"/sign_up",children:Object(h.jsx)("div",{className:"navigation-item button",children:"Become a Rebbel"})}),t&&Object(h.jsx)(P,{userSession:t,location:e}),!t&&Object(h.jsx)(b.b,{to:"/sign_in",children:Object(h.jsx)("div",{className:["navigation-item","/sign_in"===e.pathname?"active":"inactive"].join(" "),children:"Sign In"})})]})]})]})},y=n(12),N=n(63),C=n(64),S=n(65),k=n(73),w=n(23),A=n.n(w),T=n(68),D=(o.Component,n(24)),B=n.n(D),E=n(4),I=n(5),L=Object(E.a)({APP_NAME:"Rebbel Poetry"},{ENV:"production",BACKEND:"apis.rebbelpoetry.com/api",FRONTEND:"https://rebbelpoetry.com"}),F={getPoemData:function(e){return new Promise((function(t,n){I.get([L.BACKEND,"poems",e].join("/")).end((function(e,o){F.respond(o,t,n)}))}))},getPoemAuthors:function(e){return new Promise((function(t,n){I.get([L.BACKEND,"authors",e].join("/")).end((function(e,o){F.respond(o,t,n)}))}))},getUnauthenticatedFeed:function(){return new Promise((function(e,t){I.get([L.BACKEND,"poems","feed"].join("/")).end((function(n,o){F.respond(o,e,t)}))}))},updateDraft:function(e,t){return new Promise((function(n,o){I.post([L.BACKEND,"drafts"].join("/")).send(Object(E.a)({},e)).set("Authorization",t).end((function(e,t){F.respond(t,n,o)}))}))},updatePoem:function(e,t,n){return new Promise((function(o,a){I.patch([L.BACKEND,"poems",t].join("/")).send(e).set("Authorization",n).end((function(e,t){F.respond(t,o,a)}))}))},likePoem:function(e,t){return console.log(e,t),new Promise((function(n,o){I.post([L.BACKEND,"poems",e,"react"].join("/")).set("Authorization",t).end((function(e,t){F.respond(t,n,o)}))}))},bookmarkPoem:function(e,t){return console.log(e,t),new Promise((function(n,o){I.post([L.BACKEND,"poems","bookmark"].join("/")).set("Authorization",t).send({pId:e}).end((function(e,t){F.respond(t,n,o)}))}))},deletePoem:function(e,t){return new Promise((function(n,o){I.delete([L.BACKEND,"poems",e].join("/")).set("Authorization",t).end((function(e,t){F.respond(t,n,o)}))}))},getDraft:function(e,t){return new Promise((function(n,o){I.get([L.BACKEND,"drafts",e].join("/")).set("Authorization",t).end((function(e,t){F.respond(t,n,o)}))}))},getTags:function(e,t){return new Promise((function(n,o){I.get([L.BACKEND,"tags",e.join()].join("/")).set("User-Track",t).end((function(e,t){F.respond(t,n,o)}))}))},uploadThumbnail:function(e,t){return new Promise((function(n,o){I.put([L.BACKEND,"assets","upload"].join("/")).set("Authorization",t).attach("file",e).end((function(e,t){F.respond(t,n,o)}))}))},publish:function(e,t,n){return new Promise((function(o,a){I.post([L.BACKEND,"publish",e.did].join("/")).set("Authorization",n).send({tags:t.split(","),is_anonymous:e.is_anonymous}).end((function(e,t){F.respond(t,o,a)}))}))},respond:function(e,t,n){e?200===e.statusCode?t(e.body.data):n(e.body.reason||"Something went wrong."):n("No internet connection. Please connect your device and try again.")}},R=function(e){var t,n,o=e.data,s=e.isDraft,i=a.a.useState([]),c=Object(m.a)(i,2),r=c[0],l=c[1];return a.a.useEffect((function(){void 0!==o.author?F.getPoemAuthors([o.author].concat(Object(y.a)(o.featured_poets))).then((function(e){l(e)})):l([s?{display_name:"Myself",username:"me"}:{display_name:"Anonymous",username:"anonymous"}])}),[]),Object(h.jsxs)("div",{className:B.a.Poem,children:[o.thumbnail?Object(h.jsx)("div",{className:B.a.PoemThumbnail,style:{backgroundImage:"url(".concat(o.thumbnail,")")},"data-text":"Bookmarked and Liked"}):Object(h.jsx)("div",{className:B.a.PoemThumbnail,style:{backgroundImage:"url(".concat([Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_NAME:"Rebbel Poetry",REACT_APP_API_ENDPINT:"http://apis.rebbelpoetry.co/api"}).REACT_APP_API_ENDPOINT,"uploads","default-background.png"].join("/"),")")},"data-text":"Bookmarked and Liked"}),Object(h.jsx)("div",{className:B.a.PoemReadTime,children:o.read_time}),Object(h.jsxs)("div",{className:B.a.PoemDetails,children:[Object(h.jsx)("a",{className:B.a.PoemTitle,href:s?["/new_poem?draft_id=",o.did].join(""):["/poem",o._id].join("/"),children:o.title}),Object(h.jsxs)("div",{className:B.a.PoemAuthorTime,children:["By ",Object(h.jsx)("a",{href:["/"].join(""),children:null===(t=r[0])||void 0===t?void 0:t.display_name})," ",Object(h.jsx)("span",{children:"|"})," Published on ",null===o||void 0===o||null===(n=o.time_created)||void 0===n?void 0:n.day]})]})]})},H=n(69),K=n.n(H),U=function(e){var t=e.feed,n=e.isDrafts;return Object(h.jsx)("div",{className:K.a.PoemsGrid,children:t.map((function(e){return Object(h.jsx)(R,{data:e,isDraft:n})}))})},M=function(e,t){return new Promise((function(n,o){try{t&&t.constructor!==String&&(t=t.constructor===Array||t.constructor===Object?JSON.stringify(t,null,2):t.toString()),localStorage.setItem(e,t),n([e,t])}catch(a){console.error(a),o("Something went wrong while saving data")}}))},z=function(e){return new Promise((function(t,n){try{localStorage.removeItem(e),t()}catch(o){console.error(o),n(o)}}))},V=a.a.createContext({}),Y=function(e){var t=e.children,n=a.a.useState(localStorage.getItem("AUTH_TOKEN")),o=Object(m.a)(n,2),s=o[0],i=o[1];return Object(h.jsx)(V.Provider,{value:{userToken:s,setUserToken:i},children:t})},G=function(){return a.a.useContext(V)},W=n(32),q=n.n(W),Q=function(){return Object(h.jsx)("div",{className:q.a.Loader,"data-testid":"Loader",children:Object(h.jsxs)("svg",{width:"84",height:"60",viewBox:"0 0 84 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(h.jsx)("path",{className:q.a.FirstCircle,d:"M0 30C0 13.4315 13.4315 0 30 0V0C46.5685 0 60 13.4315 60 30V30C60 46.5685 46.5685 60 30 60V60C13.4315 60 0 46.5685 0 30V30Z"}),Object(h.jsx)("g",{className:q.a.BlendGroup,children:Object(h.jsx)("rect",{className:q.a.SecondCircle,x:"24",width:"60",height:"60",rx:"30",fill:"#1436AD"})})]})})},Z=a.a.createContext({}),J=function(e){var t=e.children,n=a.a.useState(!0),o=Object(m.a)(n,2),s=o[0],i=o[1];return Object(h.jsxs)(Z.Provider,{value:{isLoaderVisible:s,setIsLoaderVisible:i},children:[Object(h.jsx)("div",{className:"loader-container","data-isvisible":s,children:Object(h.jsx)(Q,{})}),t]})},X=function(){return a.a.useContext(Z)},$=n(48),ee=n.n($),te=function(e){var t=e.text,n=e.isShowClose,o=e.closeToast;return Object(h.jsxs)("div",{className:ee.a.Toast,"data-testid":"Toast",children:[Object(h.jsx)("span",{children:t}),n&&Object(h.jsx)("div",{className:ee.a.CloseButton,onClick:o,children:"Close"})]})},ne=a.a.createContext({}),oe=function(e){var t=e.children,n=a.a.useState(null),o=Object(m.a)(n,2),s=o[0],i=o[1],c=a.a.useState(!1),r=Object(m.a)(c,2),l=r[0],d=r[1];return Object(h.jsxs)(ne.Provider,{value:{showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;i(e),t>3e3&&(d(!0),i("Showing close button")),setTimeout((function(){i(null),d(!1)}),t)},isShowClose:l},children:[t,s&&Object(h.jsx)(te,{text:s,isShowClose:l,closeToast:function(){return i(null)}})]})},ae=function(){return a.a.useContext(ne)},se=function(){var e=G().userToken,t=(ae().showToast,X().setIsLoaderVisible),n=a.a.useState([]),s=Object(m.a)(n,2),i=s[0],c=s[1];return Object(o.useEffect)((function(){document.title=["Rebbel Poetry","Discover"].join(": "),t(!0),e?F.getUnauthenticatedFeed().then((function(e){console.log(e),t(!1),c([].concat(Object(y.a)(i),Object(y.a)(e)))})):F.getUnauthenticatedFeed().then((function(e){t(!1),c([].concat(Object(y.a)(i),Object(y.a)(e)))}))}),[]),Object(h.jsx)(a.a.Fragment,{children:Object(h.jsx)("div",{className:"page-container",children:Object(h.jsx)(U,{feed:i})})})},ie=n(70),ce=n.n(ie),re=function(){return Object(o.useEffect)((function(){document.title=["Rebbel Poetry","Page Not Found"].join(": ")}),[]),Object(h.jsx)("div",{className:"page-container",style:{transform:"translateY(-100px)"},children:Object(h.jsx)("div",{className:ce.a.NotFoundPage,"data-testid":"NotFoundPage",children:Object(h.jsxs)("section",{children:[Object(h.jsx)("h1",{children:"Opps, for the one who's lost \u2014 this is a dead-end!"}),Object(h.jsxs)("p",{children:["You seem to have fallen off the wagon. Trace your way ",Object(h.jsx)(b.b,{to:"/",children:"back to home."})]})]})})})},le=n(35),de=n.n(le),ue=function(e){var t=e.poet;return Object(h.jsxs)("a",{className:de.a.Poet,href:["/rebbels/@",t.username].join(""),children:[Object(h.jsx)("div",{className:de.a.PoetAvatar,style:{}}),Object(h.jsx)("div",{className:"PoetDetails",children:Object(h.jsx)("b",{className:de.a.PoetName,children:t.display_name.split(" ")[0]})})]})},je=n(71),be=n.n(je),me=n(27),he=n.n(me),fe=function(){var e=a.a.useState([]),t=Object(m.a)(e,2),n=t[0],s=t[1],i=a.a.useState([]),c=Object(m.a)(i,2),r=c[0],l=c[1],d=x().userSession,u=Object(j.g)(),b=X().setIsLoaderVisible,f=he.a.parse(u.location.search,{ignoreQueryPrefix:!0}),O=a.a.useState(f),p=Object(m.a)(O,2),_=p[0],g=p[1],P=a.a.useState(""),v=Object(m.a)(P,2),y=v[0],N=v[1],C=a.a.useCallback((function(){b(!0),N(""),I.get([L.BACKEND,"rebbels?limit=10&start="+_.index].join("/")).set("Authorization",d?d.token:void 0).end((function(e,t){b(!1),t?(console.log(t.body),200===t.statusCode?(s(t.body.data.rebbels),S(t.body.data.total_count)):(N(t.body.reason||"An error has occurred while retrieving the poets from the server"),S(1))):(N("An error has occurred while retrieving the poets from the server"),S(1))}))})),S=function(e){l([]);for(var t=[],n=1;n<=e;n++)t.push(n);l(t)};return Object(o.useEffect)((function(){document.title=["Rebbel Poetry","All Rebbel Poets"].join(": "),_.index||g(Object(E.a)(Object(E.a)({},_),{},{index:1})),C()}),[]),Object(h.jsxs)("div",{className:"page-container",children:[Object(h.jsxs)("div",{className:"page-header",children:[Object(h.jsx)("span",{className:"name",children:"All Rebbels"}),Object(h.jsx)("div",{className:"flex-space"}),Object(h.jsx)("a",{href:"/search?filter=by_rebbel",children:Object(h.jsx)("span",{children:"Filter"})})]}),!y&&Object(h.jsxs)("div",{className:be.a.Poets,children:["1"===_.index&&Object(h.jsx)(ue,{poet:{display_name:"Anonymous",username:"anonymous"}}),n.map((function(e){return Object(h.jsx)(ue,{poet:e},e._id)}))]}),y&&Object(h.jsx)("div",{children:Object(h.jsxs)("h2",{style:{textAlign:"center"},children:[y," \u2014"," ",Object(h.jsx)("a",{style:{fontSize:"50px",color:"white",userSelect:"none"},onClick:function(){return C()},children:"Try this again."})]})}),!!r.length&&Object(h.jsxs)("div",{className:"more-pages",children:[Object(h.jsx)("div",{className:"more-pages-title",children:"More Rebbels"}),Object(h.jsx)("div",{className:"more-pages-links",children:r.map((function(e){return Object(h.jsx)("a",{href:["/rebbels?index=",e].join(""),"data-isactive":e.toString()===_.index,children:e},e)}))})]})]})},Oe=n(15),xe=n.n(Oe),pe=function(){var e=Object(j.i)(),t=x().userSession,n=X().setIsLoaderVisible,o=a.a.useState(null),s=Object(m.a)(o,2),i=s[0],c=s[1],r=a.a.useState([]),l=Object(m.a)(r,2),d=l[0],u=l[1],f=a.a.useCallback((function(){return new Promise((function(o,a){t&&t.username===e.poet||(n(!0),I.get([L.BACKEND,"rebbels",e.poet].join("/")).end((function(e,t){n(!1),t&&200===t.statusCode&&(o(t.body.data),document.title=["Rebbel Poetry",[t.body.data.display_name," (@",t.body.data.username,")"].join("")].join(": "))})))}))}));return a.a.useEffect((function(){f().then((function(e){c(e),e.poems.forEach((function(e){return F.getPoemData(e).then((function(e){var t=d;t.push(e),u(t)}))}))}))}),[]),i&&Object(h.jsxs)("div",{style:{width:"100%"},className:"page-container",children:[Object(h.jsxs)("div",{className:xe.a.ProfilePage,children:[Object(h.jsx)("div",{className:xe.a.ProfileAvatarContainer,children:Object(h.jsx)("div",{className:xe.a.ProfileAvatar,style:{backgroundImage:"url(".concat(i.display_photo,")")}})}),Object(h.jsxs)("div",{className:xe.a.PageContents,children:[Object(h.jsxs)("div",{className:xe.a.ProfileName,children:[Object(h.jsxs)("span",{className:xe.a.Name,children:[i.display_name," ",t&&t.username===i.username?"(Me)":""]}),Object(h.jsx)("span",{className:xe.a.ProfleVerificationSign})]}),Object(h.jsxs)("div",{className:xe.a.ProfileBiography,children:[Object(h.jsx)("span",{children:i.biography}),t&&t.username===i.username?0!==i.biography.length?Object(h.jsx)(b.b,{className:xe.a.ProfileBiographyEditButton,children:"Edit"}):Object(h.jsx)(b.b,{className:xe.a.ProfileBiographyEditButton,style:{transform:"translateX(-20px)"},children:"Add a biography"}):""]}),Object(h.jsxs)("div",{className:xe.a.ProfileHeaderButtons,children:[t&&t.username===i.username?"":Object(h.jsx)("button",{style:{backgroundColor:"black"},children:"Follow Rebbel"}),t&&t.username===i.username?Object(h.jsx)("button",{children:"Share your profile"}):Object(h.jsx)("button",{children:"Share Profile"}),t&&t.username===i.username?"":Object(h.jsx)("button",{children:"Collaborate"})]}),Object(h.jsxs)("div",{className:xe.a.ProfileStats,children:[Object(h.jsxs)(b.b,{children:[Object(h.jsx)("b",{children:i.poems.length})," Poems Published"]}),Object(h.jsxs)(b.b,{children:[Object(h.jsx)("b",{children:i.followers.length})," Followers"]}),Object(h.jsxs)(b.b,{children:[Object(h.jsx)("b",{children:i.follows.length})," Follows"]})]})]})]}),Object(h.jsx)("div",{style:{width:"100%"},children:i.poems.length?Object(h.jsx)(U,{feed:d}):Object(h.jsxs)("h1",{children:[i.display_name," has not published any poems yet."]})})]})},_e=n(18),ge=n.n(_e),Pe=function(e){var t,n,o,s,i,c,r,l=e.poemData,d=a.a.useState([]),u=Object(m.a)(d,2),j=u[0],f=u[1];return a.a.useEffect((function(){l&&(void 0!==l.author?F.getPoemAuthors([l.author].concat(Object(y.a)(l.featured_poets))).then((function(e){console.log(e),f(e)})):f([{display_name:"Anonymous",username:"anonymous"}]))}),[l]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:ge.a.PoemPageHeader,children:Object(h.jsx)("div",{className:ge.a.BackgroundDiffuser,children:Object(h.jsxs)("div",{className:ge.a.PoemInformationContainer,children:[Object(h.jsx)("div",{children:Object(h.jsx)("div",{className:ge.a.PoemThumbnailImage,style:{backgroundImage:"url(".concat(l.thumbnail,")")},children:Object(h.jsx)("div",{className:ge.a.PlayPauseButton})})}),Object(h.jsxs)("div",{className:ge.a.PoemDetailsContainer,children:[Object(h.jsx)("h2",{className:ge.a.PoemTitle,children:null===l||void 0===l?void 0:l.title}),Object(h.jsxs)("div",{className:ge.a.PoemAuthor,children:["Written by"," ",Object(h.jsx)(b.b,{to:"/rebbels/@".concat(null===(t=j[0])||void 0===t?void 0:t.username),children:null===(n=j[0])||void 0===n?void 0:n.display_name})]}),Object(h.jsx)("table",{className:ge.a.PoemMetadataItems,children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Read time"}),Object(h.jsx)("td",{children:Object(h.jsx)("a",{href:["/search?keyword=",null===l||void 0===l||null===(o=l.read_time)||void 0===o?void 0:o.split(" ").join("+")].join(""),children:null===l||void 0===l?void 0:l.read_time})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Word count"}),Object(h.jsxs)("td",{children:[(null===l||void 0===l||null===(s=l.body)||void 0===s?void 0:s.split(" ").length)||0," words"]})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Published on"}),Object(h.jsx)("td",{children:Object(h.jsx)("a",{href:["/search?keyword=",null===l||void 0===l||null===(i=l.time_created)||void 0===i||null===(c=i.day)||void 0===c?void 0:c.split(" ").join("+")].join(""),children:null===l||void 0===l||null===(r=l.time_created)||void 0===r?void 0:r.day})})]})]})})]}),Object(h.jsx)("div",{className:ge.a.PoemStats,children:Object(h.jsx)("div",{})})]})})})})},ve=n(49),ye=n.n(ve),Ne={comment:function(e,t){return new Promise((function(n,o){I.post([L.BACKEND,"poems",e.pId,"comments"].join("/")).set("Authorization",t).send(e).end((function(e,t){Ne.respond(t,n,o)}))}))},getComments:function(e){return new Promise((function(t,n){I.get([L.BACKEND,"poems",e,"comments?start=0&limit=20"].join("/")).end((function(e,o){Ne.respond(o,t,n)}))}))},react:function(e,t){return new Promise((function(n,o){I.post([L.BACKEND,"poems","comments",e,"react"].join("/")).set("Authorization",t).end((function(e,t){Ne.respond(t,n,o)}))}))},update:function(e,t,n){return new Promise((function(o,a){I.patch([L.BACKEND,"poems","comments",t].join("/")).set("Authorization",n).send({body:e}).end((function(e,t){Ne.respond(t,o,a)}))}))},delete:function(e,t){return new Promise((function(n,o){I.delete([L.BACKEND,"poems","comments",e].join("/")).set("Authorization",t).end((function(e,t){Ne.respond(t,n,o)}))}))},respond:function(e,t,n){e?200===e.statusCode?t(e.body.data):n(e.body.reason||"Something went wrong."):n("No internet connection. Please connect your device and try again.")}},Ce=n(44),Se=n.n(Ce),ke=n(19),we=n.n(ke),Ae=function(e){var t,n,o=e.comment,s=e.update,i=G(),c=x().userSession,r=a.a.useState(!1),l=Object(m.a)(r,2),d=l[0],j=l[1],f=a.a.useState([]),O=Object(m.a)(f,2),p=O[0],_=O[1],g=a.a.createRef();return a.a.useEffect((function(){F.getPoemAuthors([o.commenter,"61353484137f33dd6430333c"]).then((function(e){e.length&&_(e[0])}))}),[o]),Object(h.jsxs)("div",{className:we.a.Comment,children:[Object(h.jsxs)("div",{className:we.a.CommentActions,children:[Object(h.jsx)("div",{className:we.a.CommentLikesCount,children:null===o||void 0===o?void 0:o.likes_count}),Object(h.jsx)("div",{className:we.a.CommentActionButtons,children:Object(h.jsx)("div",{className:we.a.Like,"data-isliked":o.likes.includes(null===c||void 0===c?void 0:c._id),onClick:function(){return Ne.react(o._id,i.userToken).then((function(e){e.is_like?o.likes.push(null===c||void 0===c?void 0:c._id):o.likes.splice(o.likes.indexOf(null===c||void 0===c?void 0:c._id),1),o.likes_count=e.likes_count,s(o,o._id)}))},children:Object(h.jsx)(u.a,{name:"heart-sharp"})})})]}),Object(h.jsxs)("div",{className:we.a.CommentBody,children:[!d&&Object(h.jsx)(Se.a,{children:o.body}),d&&Object(h.jsx)("textarea",{rows:"2",placeholder:"Type your comment...",defaultValue:o.body,ref:g}),Object(h.jsxs)("span",{className:we.a.CommentorNameDate,children:["\u2014 By"," ",Object(h.jsx)(b.b,{to:"/rebbels/@".concat(p.username),children:null===p||void 0===p?void 0:p.display_name})," ","on"," ",Object(h.jsxs)("strong",{children:[null===(t=o.time_created)||void 0===t?void 0:t.day," at ",null===o||void 0===o||null===(n=o.time_created)||void 0===n?void 0:n.time]})]}),Object(h.jsxs)("div",{className:we.a.CommentMoreActions,children:[Object(h.jsx)("a",{onClick:function(){d?Ne.update(g.current.value,o._id,i.userToken).then((function(){s(Object(E.a)(Object(E.a)({},o),{},{body:g.current.value}),o._id),j(!d)})):j(!d)},children:d?"Save changes":"Edit"}),Object(h.jsx)("a",{onClick:function(){return Ne.delete(o._id,i.userToken).then((function(){s(void 0,o._id)}))},children:"Delete"})]})]})]})},Te=function(){var e=X().setIsLoaderVisible,t=Object(j.i)(),n=G(),o=a.a.createRef(),s=a.a.useState([]),i=Object(m.a)(s,2),c=i[0],r=i[1];return a.a.useEffect((function(){Ne.getComments(t.poemId).then((function(e){r(e)})).catch((function(e){return console.log(e)}))}),[]),Object(h.jsxs)("section",{className:ye.a.CommentsSection,"data-testid":"CommentsSection",children:[c.map((function(e){return Object(h.jsx)(Ae,{comment:e,update:function(e,t){var n=c.findIndex((function(e){return e._id===t}));if(n>-1){var o=Object(y.a)(c);e?o[n]=e:o.splice(n,1),r(o)}}})})),Object(h.jsxs)("div",{className:ye.a.PostCommentField,children:[Object(h.jsx)("textarea",{rows:"2",placeholder:"Type your comment...",ref:o}),Object(h.jsx)("button",{onClick:function(){e(!0),Ne.comment({pId:t.poemId,body:o.current.value},n.userToken).then((function(t){r([].concat(Object(y.a)(c),[t])),o.current.value="",e(!1)})).catch((function(t){e(!1),console.log("error",t)}))},children:"Post your comment"})]})]})},De=n(36),Be=n.n(De),Ee=function(e){var t=e.pId,n=e.pTitle,o=a.a.useState([L.FRONTEND,"poem",t].join("/")),s=Object(m.a)(o,2),i=s[0],c=(s[1],ae().showToast);return Object(h.jsxs)("div",{className:Be.a.PoemShareContents,"data-testid":"PoemShareContents",children:[Object(h.jsx)("h4",{children:"Share with your friends"}),Object(h.jsxs)("div",{className:Be.a.ShareLinkInput,children:[Object(h.jsx)("input",{type:"text",value:i,disabled:!0}),Object(h.jsx)("button",{onClick:function(){navigator.clipboard.writeText(i).then((function(){return c("Your share link has been copied.")}))},children:"Copy Link"})]}),Object(h.jsx)("h6",{children:"You can also share to"}),Object(h.jsxs)("div",{className:Be.a.SocialMediaShare,children:[Object(h.jsx)("a",{href:["https://api.whatsapp.com/send?text=Read poem ",n," on Rebbel Poetry using link ",i].join(""),target:"_blank",children:Object(h.jsx)(u.a,{name:"logo-whatsapp"})}),Object(h.jsx)("a",{target:"_blank",href:["https://www.facebook.com/sharer/sharer.php?u=",i].join(""),class:"fb-xfbml-parse-ignore",children:Object(h.jsx)(u.a,{name:"logo-facebook"})})]})]})},Ie=n(11),Le=n.n(Ie),Fe=n(34),Re=n.n(Fe),He=function(){var e,t,n,o=X().setIsLoaderVisible,s=G().userToken,i=x(),c=i.userSession,r=i.setUserSession,l=ae().showToast,d=Object(j.g)(),b=a.a.useState(!1),f=Object(m.a)(b,2),O=f[0],p=f[1],_=a.a.createRef(),g=a.a.useState(!1),P=Object(m.a)(g,2),v=P[0],N=P[1],C=a.a.useRef(),S=a.a.useRef(),k=a.a.useState(0),w=Object(m.a)(k,2),A=w[0],T=w[1],D=a.a.useRef(),B=a.a.useState(-1),R=Object(m.a)(B,2),H=R[0],K=R[1],U=a.a.useState([]),M=Object(m.a)(U,2),z=M[0],V=M[1],Y=Object(j.i)(),W=a.a.useState({}),q=Object(m.a)(W,2),Q=q[0],Z=q[1];return a.a.useEffect((function(){o(!0),I.get([L.BACKEND,"poems",Y.poemId].join("/")).end((function(e,t){o(!1),t?200===t.status?(Z(t.body.data),F.getTags(t.body.data.tags,s).then((function(e){V(e)})),document.title=["Rebbel Poetry",": ",t.body.data.title].join("")):(l(t.body.reason||"Something went wrong."),Z(null)):(l("You're not connected with the internet."),Z(null))}))}),[]),a.a.useEffect((function(){Q.title&&Q.title.includes("Guides: ")&&C.current.classList.add("is-guide");window.addEventListener("scroll",(function(e){var t=window.scrollY,n=C.current;if(n){var o=n.getBoundingClientRect();o.y-t<=0?(S.current.style.position="fixed",S.current.style.top="200px"):(S.current.style.position="absolute",S.current.style.top="0px"),t>o.bottom+200?S.current.style.opacity=0:S.current.style.opacity=1}}))}),[Q]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:Le.a.PoemPageContainer,children:[Object(h.jsx)(Re.a,{isOpen:v,onRequestClose:function(){return N(!1)},style:{overlay:{zIndex:6e4},content:{width:"40%",height:"300px",margin:"auto",position:"absolute",bottom:"20px",borderRadius:"0px",border:"3px solid black"}},children:Object(h.jsx)(Ee,{pId:null===Q||void 0===Q?void 0:Q._id,pTitle:null===Q||void 0===Q?void 0:Q.title})}),Object(h.jsx)(Pe,{poemData:Q}),Object(h.jsxs)("div",{className:Le.a.PoemContents,children:[Object(h.jsxs)("div",{className:Le.a.PoemSplitSides,children:[Object(h.jsxs)("div",{className:Le.a.SideButtons,ref:S,children:[Object(h.jsxs)("button",{className:Le.a.Heart,"data-isLiked":null===(e=Q.likes)||void 0===e?void 0:e.includes(null===c||void 0===c?void 0:c._id),onClick:function(){F.likePoem(Q._id,s).then((function(e){Z(Object(E.a)(Object(E.a)({},Q),{},{likes_count:e.likes_count,likes:e.likes}))}))},children:[(null===(t=Q.likes)||void 0===t?void 0:t.includes(null===c||void 0===c?void 0:c._id))?Object(h.jsx)(u.a,{name:"heart"}):Object(h.jsx)(u.a,{name:"heart-outline"}),Object(h.jsx)("span",{className:"count",children:Q.likes_count})]}),Object(h.jsxs)("button",{title:"Users currently reading this poem.",children:[Object(h.jsx)(u.a,{name:"eye-outline"}),Object(h.jsx)("span",{className:"count",children:Q.views_count})]}),Object(h.jsxs)("button",{className:Le.a.Bookmark,"data-isBookmarked":null===c||void 0===c?void 0:c.bookmarked_poems.includes(Q._id),onClick:function(){s?F.bookmarkPoem(Q._id,s).then((function(e){if(Z(Object(E.a)(Object(E.a)({},Q),{},{bookmarks_count:e.bookmarks_count})),e.is_bookmark)r(Object(E.a)(Object(E.a)({},c),{},{bookmarked_poems:[].concat(Object(y.a)(c.bookmarked_poems),[Q._id])}));else{var t=c.bookmarked_poems,n=t.indexOf(Q._id);n>-1&&(t.splice(n,1),r(Object(E.a)(Object(E.a)({},c),{},{bookmarked_poems:t})))}console.log("User session",c)})):l("You are not logged in. Sign in to bookmark this poem.")},children:[(null===c||void 0===c?void 0:c.bookmarked_poems.includes(Q._id))?Object(h.jsx)(u.a,{name:"bookmark-sharp"}):Object(h.jsx)(u.a,{name:"bookmark-outline"}),Object(h.jsx)("span",{className:"count",children:Q.bookmarks_count})]}),Object(h.jsxs)("button",{className:Le.a.Share,onClick:function(){N(!v)},children:[Object(h.jsx)(u.a,{name:"share-outline"}),Object(h.jsx)("span",{className:"count",children:"Share"})]})]}),Object(h.jsxs)("div",{className:Le.a.PoemTextContainer,ref:C,children:[c&&c._id===Q.author&&Object(h.jsxs)("div",{className:Le.a.PoemActions,children:[Object(h.jsx)("a",{onClick:function(){var e=!O;p(e),e?_.current.innerText=Q.body:(_.current.innerText="",F.updatePoem({body:Q.body},Q._id,s))},children:O?"Update":"Edit"}),O?Object(h.jsx)("a",{className:"color-danger",onClick:function(){return p(!1)},children:"Cancel"}):Object(h.jsx)("a",{className:"color-danger",onClick:function(){F.deletePoem(Q._id,s).then((function(){l("Poem deleted."),d.push("/discover")})).catch((function(e){return console.log("ERRRROR:",e)}))},children:"Delete"}),Object(h.jsx)("div",{ref:_,onKeyUp:function(){return Z(Object(E.a)(Object(E.a)({},Q),{},{body:_.current.innerText}))},contentEditable:"true",style:{borderBottom:O?"3px solid black":"none",paddingBottom:O?"20px":"0"}}),O&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("br",{}),Object(h.jsx)("h5",{children:"Resulting Changes:"}),Object(h.jsx)("br",{})]})]}),Object(h.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:function(e){if(e){for(var t=e.split("|"),n=[],o=function(e){if(t[e].includes("=")){var o=t[e].split("="),a=o[0],s=o[1];n.push(Object(h.jsx)("a",{onClick:function(t){!function(e,t){if(t){var n=t.target.getBoundingClientRect(),o=C.current.getBoundingClientRect(),a=n.y-o.y;D.current.style.display="block",D.current.innerHTML=e;var s=D.current.getBoundingClientRect(),i=a+s.height;o.height-i<0&&(a=o.height-s.height),T(a),D.current.style.transform=["translateY(",a,"px)"].join("")}else T(0),D.current.style.display="block"}(s,t),K(e)},"data-index":e,"data-isactive":e===H,children:a}))}else n.push(Object(h.jsx)("span",{children:t[e]}))},a=0;a<t.length;a++)o(a);return n}return Object(h.jsx)("span",{children:"Loading..."})}(Q.body)})]}),Object(h.jsx)("div",{className:Le.a.AnnotationsContainer,style:{translate:"translateY(".concat(A,"px)")},ref:D,children:Object(h.jsx)("i",{children:"Click on an annotation to read more about it's text."})})]}),z.length>0&&Object(h.jsxs)("div",{className:Le.a.PoemTags,children:[Object(h.jsx)("span",{children:"Tags"}),z.map((function(e){return Object(h.jsx)("a",{href:["/search?keyword=",e.name.toLowerCase().split(" ").join("+")].join(""),className:"tag",children:e.name})}))]}),Object(h.jsxs)("div",{className:Le.a.CommentsSection,children:[Object(h.jsxs)("h4",{className:Le.a.CommentsSectionHeader,children:[Object(h.jsx)("span",{className:Le.a.Name,children:"Community Commentations"}),Object(h.jsxs)("span",{className:Le.a.Count,children:[(null===(n=Q.comments)||void 0===n?void 0:n.length)?[Q.comments.length,"Comments"].join(" "):"No comments"," ","posted"]})]}),Object(h.jsx)(Te,{commentIds:Q.comments})]})]})]})})},Ke=n(28),Ue=n.n(Ke),Me=function(){var e,t,n=a.a.useState(null),s=Object(m.a)(n,2),i=s[0],c=s[1],r=a.a.useState({}),l=Object(m.a)(r,2),d=l[0],b=l[1],f=X().setIsLoaderVisible,O=ae().showToast,x=Object(j.g)();console.log(x);var p=function(e){x.push([x.location.pathname,"?keyword=",i].join("")),b({}),f(!0),I.get([L.BACKEND,["search?keyword=",(i||e).split(" ").join("+")].join("")].join("/")).end((function(e,t){f(!1),t?200===t.status?(b(t.body.data),console.log(t.body)):O(t.body.reason||"Something went wrong."):O("No internet connection.")}))};return Object(o.useEffect)((function(){var e=he.a.parse(x.location.search,{ignoreQueryPrefix:!0});document.title=["Rebbel Poetry","Search"].join(": "),e.keyword&&(c(e.keyword),p(e.keyword))}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"page-container",children:[Object(h.jsx)("h1",{className:Ue.a.PageTitle,children:"Search"}),Object(h.jsxs)("div",{className:Ue.a.SearchInputContainer,children:[Object(h.jsx)("input",{className:Ue.a.LargeSearchInput,type:"text",defaultValue:i,placeholder:"Search for Rebbel Poems / Rebbel Poets",onKeyUp:function(e){c(e.target.value),b({})}}),Object(h.jsx)("div",{className:Ue.a.SearchButton,onClick:p,children:Object(h.jsx)(u.a,{name:"arrow-forward-sharp"})})]}),d.poems&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("h4",{style:{textAlign:"center"},children:[(null===(e=d.poems)||void 0===e?void 0:e.length)||(null===(t=d.authors)||void 0===t?void 0:t.length)?"All results for ":"No results found for keyword"," ",'"',i,'"']}),!!d.authors.length&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"Rebbel Poets"}),Object(h.jsx)("div",{className:Ue.a.Rebbels,children:d.authors.map((function(e){return Object(h.jsx)(ue,{poet:e})}))})]}),!!d.poems.length&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"Poems Results"}),Object(h.jsx)(U,{feed:d.poems})]})]})]})})},ze=n(16),Ve=n.n(ze),Ye=function(){return Object(h.jsxs)("div",{className:Ve.a.FooterContainer,children:[Object(h.jsxs)("div",{className:Ve.a.Footer,children:[Object(h.jsxs)("section",{className:Ve.a.LeftSection,children:[Object(h.jsx)("img",{src:c,alt:""}),Object(h.jsx)("a",{className:Ve.a.BrandName,href:"/",children:"Rebbel Poetry"}),Object(h.jsxs)("div",{className:Ve.a.Legal,children:["All poems on this site are part of copyrights of their respective poets. All content on this site is published here under"," ",Object(h.jsx)("a",{href:"https://creativecommons.org/licenses/",target:"_blank",children:"Creative Commons License"}),"."]})]}),Object(h.jsxs)("section",{className:Ve.a.FirstMiddleSection,children:[Object(h.jsx)("div",{className:Ve.a.SectionName,children:"Navigation"}),Object(h.jsx)(b.b,{to:"/",children:"Top Ranked Poems"}),Object(h.jsx)(b.b,{to:"/poets",children:"Top Rebel Poets"}),Object(h.jsx)(b.b,{to:"/my_drafts",children:"View your Drafts"}),Object(h.jsx)(b.b,{to:"/feeling_lucky",children:"I'm Feeling Lucky"}),Object(h.jsx)(b.b,{to:"/search",children:"Search Poems"})]}),Object(h.jsxs)("section",{className:Ve.a.SecondMiddleSection,children:[Object(h.jsx)("div",{className:Ve.a.SectionName,children:"Poems"}),Object(h.jsx)(b.b,{to:"/",children:"All Poems"}),Object(h.jsx)(b.b,{to:"/",children:"Poem By Language"}),Object(h.jsx)(b.b,{to:"/",children:"Explore All Poets"}),Object(h.jsx)(b.b,{to:"/",children:"Competitions"})]}),Object(h.jsxs)("section",{className:Ve.a.SecondMiddleSection,children:[Object(h.jsx)("div",{className:Ve.a.SectionName,children:"General"}),Object(h.jsx)(b.b,{to:"/",children:"Donate"}),Object(h.jsx)(b.b,{to:"/",children:"About Us"}),Object(h.jsx)(b.b,{to:"/",children:"Licensing"}),Object(h.jsx)(b.b,{to:"/",children:"Legal"})]})]}),Object(h.jsxs)("div",{className:Ve.a.Attribution,children:["Rebbel Poetry (Pty) Ltd. Copyright \xa9 ",(new Date).getFullYear(),". All right reserved."]})]})},Ge=n(22),We=n(72),qe=n.n(We),Qe=function(){var e=x().setUserSession,t=Object(j.g)();Object(o.useEffect)((function(){document.title=["Rebbel Poetry","Create an account"].join(": ")}),[]);var n=Object(o.useState)({email_address:"",display_name:"",password:""}),a=Object(m.a)(n,2),s=a[0],i=a[1],c=Object(o.useState)(""),r=Object(m.a)(c,2),l=r[0],d=r[1],u=function(e){e.target.name&&i(Object(E.a)(Object(E.a)({},s),{},Object(Ge.a)({},e.target.name,e.target.value)))};return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"page-container",children:Object(h.jsxs)("form",{onSubmit:function(n){n.preventDefault(),d(""),s.email_address&&s.display_name&&s.password?I.post([L.BACKEND,"rebbels"].join("/")).send(s).end((function(n,o){o?200===o.statusCode?(M("AUTH_TOKEN",o.body.data.token),e(o.body.data),t.push("/")):208===o.statusCode&&d("Account with that email address already exists. Please sign in if this is your account."):d("You are not connected to the internet. Please check your connection and try again.")})):d("All fields are mandatory, please make sure you fill every field to create an account.")},className:"form",children:[Object(h.jsx)("h1",{children:"Join Rebbels"}),l?Object(h.jsxs)("p",{className:[qe.a.ResponseError,"danger"].join(" "),children:[" ",Object(h.jsx)("b",{children:l})," "]}):"",Object(h.jsx)("input",{type:"text",placeholder:"Email address",name:"email_address",onKeyUp:u}),Object(h.jsx)("input",{type:"text",placeholder:"Your name",name:"display_name",onKeyUp:u}),Object(h.jsx)("input",{type:"password",placeholder:"Enter a password",name:"password",onKeyUp:u}),Object(h.jsx)("button",{type:"submit",children:"Become a Member"}),Object(h.jsxs)("p",{children:["We are glad to have you onboard, by creating an account you agree to our ",Object(h.jsx)(b.b,{to:"",children:"Terms and Conditions"}),". If you are already a member you can ",Object(h.jsx)(b.b,{to:"/sign_in",children:"Sign in to your account."})]})]})})})},Ze=function(){var e=a.a.useState(""),t=Object(m.a)(e,2),n=t[0],o=t[1],s=x().setUserSession,i=G().setUserToken,c=a.a.useState({username:"",password:""}),r=Object(m.a)(c,2),l=r[0],d=r[1],u=Object(j.g)(),f=function(e){e.target.name&&d(Object(E.a)(Object(E.a)({},l),{},Object(Ge.a)({},e.target.name,e.target.value)))};return Object(h.jsx)(a.a.Fragment,{children:Object(h.jsx)("div",{className:"page-container",children:Object(h.jsxs)("form",{action:"",className:"form",onSubmit:function(e){if(e.preventDefault(),o(""),l.username&&l.password){var t=["Basic",btoa([l.username,l.password].join(":"))].join(" ");I.get([L.BACKEND,"rebbels/authentication"].join("/")).set("Authorization",t).end((function(e,t){t?200===t.statusCode?(M("AUTH_TOKEN",t.body.data.token),s(t.body.data),i(t.body.data.token),u.push("/discover")):o(t.body.reason||"Something went wrong. Please try again, contact us if error persists."):o("No internet, please check your connection and try again.")}))}else o("All fields are required. Please make sure they are all filled.")},children:[Object(h.jsx)("h1",{children:"Login"}),n&&Object(h.jsx)("p",{className:"danger",children:n}),Object(h.jsx)("input",{type:"text",placeholder:"Your email or username",name:"username",onKeyUp:f}),Object(h.jsx)("input",{type:"password",placeholder:"Password",name:"password",onKeyUp:f}),Object(h.jsx)("button",{children:"Sign In to your Account"}),Object(h.jsxs)("p",{children:["By signing in you agree to out"," ",Object(h.jsx)(b.b,{to:"",children:"Terms and Conditions"}),". If you don't have an account you can ",Object(h.jsx)(b.b,{to:"/sign_up",children:"create one here."})]})]})})})},Je=(n(157),function(){var e=a.a.useState([]),t=Object(m.a)(e,2),n=t[0],o=t[1],s=ae().showToast,i=G();return a.a.useEffect((function(){I.get([L.BACKEND,"drafts"].join("/")).set("Authorization",i.userToken).end((function(e,t){t?200===t.status?o(t.body.data):s(t.reason||"Something went wrong."):(s("You are not connected to the internet."),o(null))}))}),[]),Object(h.jsxs)("div",{className:"page-container","data-testid":"DraftsPage",children:[null===n&&Object(h.jsx)("div",{children:Object(h.jsxs)("section",{children:[Object(h.jsx)("h1",{children:"Something happened while retrieving your drafts."}),Object(h.jsx)("p",{children:"If this error persists, please contact us and let us know about the issue."})]})}),null!==n&&Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"All Your Drafts"}),Object(h.jsx)(U,{feed:n,isDrafts:!0})]})]})}),Xe=(n(158),function(){var e=Object(j.g)(),t=ae().showToast,n=a.a.useState(!1),o=Object(m.a)(n,2),s=o[0],i=o[1];return a.a.useEffect((function(){I.get([L.BACKEND,"poems","feeling_lucky"].join("/")).end((function(n,o){o?200===o.status?e.push(["/poem",o.body.data._id].join("/")):(t(o.body.reason||"Something went wrong."),i(!0)):(t("You're are not connected to the internet."),i(!0))}))}),[]),Object(h.jsxs)("div",{className:"page-container",children:[s&&Object(h.jsx)("div",{children:Object(h.jsxs)("section",{children:[Object(h.jsx)("h1",{children:"Something happened while retrieving a random poem."}),Object(h.jsx)("p",{children:"If this error persists, please contact us and let us know about the issue."})]})}),!s&&Object(h.jsx)("div",{children:Object(h.jsxs)("section",{style:{textAlign:"center"},children:[Object(h.jsx)("h1",{style:{marginBottom:"20px"},children:"Let's spoil up!"}),Object(h.jsx)(Q,{})]})})]})}),$e=(n(159),function(e){var t=e.children,n=x().setUserSession,o=X().setIsLoaderVisible,s=Object(j.g)(),i=G().userToken;return a.a.useEffect((function(){i&&I.get([L.BACKEND,"rebbels","reauthenticate"].join("/")).set("Authorization",i).end((function(e,t){o(!1),t&&(200===t.statusCode?n(t.body.data):(404===t.statusCode?console.log("Not found."):403===t.statusCode?console.log("Unauthorized."):510===t.statusCode?console.log("Session expired."):console.log("Something went wrong."),z("AUTH_TOKEN"),console.log("Restart."),s.push("/sign_in")))}))}),[]),Object(h.jsx)(h.Fragment,{children:t})}),et=n(20),tt=n.n(et),nt=n(74),ot=n(21),at=n.n(ot),st=function(e){var t=e.data,n=(e.token,e.isPublished),o=G().userToken,s=X(),i=s.isLoaderVisible,c=s.setIsLoaderVisible,r=a.a.useState(0),l=Object(m.a)(r,2),d=(l[0],l[1]),u=a.a.createRef(),j=a.a.createRef(),b=a.a.useState(-1),f=Object(m.a)(b,2),O=f[0],x=f[1];return a.a.useState((function(){window.addEventListener("resize",(function(){var e=document.getElementById("draft-container");e&&d(e.innerWidth),console.log(e)}))}),[]),Object(h.jsxs)("div",{className:at.a.DraftPreview,id:"draft-container",onScroll:function(e){console.log(e)},children:[Object(h.jsxs)("div",{className:at.a.DraftTitle,children:[t.title||"No title entered yet."," (preview)"]}),Object(h.jsxs)("div",{className:at.a.DraftSplitSides,children:[Object(h.jsx)("div",{className:at.a.DraftContents,children:Object(h.jsx)("p",{className:at.a.DraftAnnotationsText,style:{whiteSpace:"pre-wrap"},children:function(e){if(e){for(var t=e.split("|"),n=[],o=function(e){if(console.log(t[e]),t[e].includes("=")){var o=t[e].split("="),a=o[0],s=o[1];console.log(a,s),n.push(Object(h.jsx)("a",{onClick:function(t){!function(e,t){j.current&&(j.current.innerText=e)}(s),x(e)},"data-index":e,"data-isactive":e===O,children:a}))}else n.push(Object(h.jsx)("span",{children:t[e]}))},a=0;a<t.length;a++)o(a);return n}return Object(h.jsx)("span",{children:"Loading..."})}(t.body)||"Click on an annotation to read it's description"})}),Object(h.jsx)("div",{className:at.a.DraftAnnotations,children:Object(h.jsx)("div",{className:at.a.DraftAnnotationsText,ref:j,children:"Click on an annotation to read it's description"})})]}),Object(h.jsxs)("div",{className:at.a.BottomButtons,children:[Object(h.jsx)("input",{placeholder:"Comma seperated Tags, eg. Love, Teenagers, Fun",ref:u}),Object(h.jsx)("button",{disabled:i,className:"primary",onClick:function(){c(!0),F.publish(t,u.current.value,o).then((function(e){c(!1),n(e.toUpperCase())}))},children:"Publish Poem"})]})]})};var it=function(){var e=G().userToken,t=X().setIsLoaderVisible,n=ae().showToast,o=a.a.useState(!1),s=Object(m.a)(o,2),i=s[0],c=s[1],r=Object(j.g)(),l=a.a.useState({did:"",title:"",body:"",thumbnail:"",tags:[],featured_poets:[],is_anonymous:!1,time_created:(new Date).toISOString(),is_created:!1}),d=Object(m.a)(l,2),f=d[0],O=d[1],x=a.a.useState(null),p=Object(m.a)(x,2),_=(p[0],p[1],a.a.createRef());a.a.useState((function(){document.title=["Rebbel Poetry","New Poem"].join(": ");var t=he.a.parse(r.location.search,{ignoreQueryPrefix:!0}),n=Object(nt.a)().toUpperCase();t.draft_id?(O(Object(E.a)(Object(E.a)({},f),{},{did:t.draft_id})),F.getDraft(t.draft_id,e).then((function(e){console.log("Found draft:",e),O({did:t.draft_id,thumbnail:e.thumbnail,title:e.title,body:e.body,featured_poets:e.featured_poets,time_created:e.time_created.toString(),is_anonymous:e.is_anonymous,is_created:!0})})).catch((function(e){return console.log(e)}))):(O(Object(E.a)(Object(E.a)({},f),{},{did:n})),r.push([r.location.pathname,"?draft_id=",n].join("")))}),[]);var g=function(e){var t={name:e.target.name,value:e.target.value};O(Object(E.a)(Object(E.a)({},f),{},Object(Ge.a)({},t.name,t.value))),"title"===e.target.name&&(_.current.style.height=_.current.scrollHeight+"px")},P=a.a.useRef();return a.a.useEffect((function(){}),[]),Object(h.jsxs)("div",{className:tt.a.PageContainer,children:[Object(h.jsx)(Re.a,{isOpen:i,onRequestClose:function(){return c(!1)},style:{overlay:{zIndex:6e4},content:{width:"80%",margin:"auto",borderRadius:"0px",border:"3px solid black"}},children:Object(h.jsx)(st,{data:f,isPublished:function(e){c(!1),r.push(["/poem/",e].join(""))},token:e})}),Object(h.jsxs)("div",{className:tt.a.NewPoemHeaderContainer,style:{backgroundImage:"url(".concat(f.thumbnail,")")},children:[Object(h.jsxs)("div",{className:tt.a.NewPoemImageContainer,children:[Object(h.jsx)("input",{type:"file",ref:P,onChange:function(){if(P.current.files.length){var t=new FileReader;t.onloadend=function(){return O(Object(E.a)(Object(E.a)({},f),{},{thumbnail:t.result}))},t.readAsDataURL(P.current.files[0]),F.uploadThumbnail(P.current.files[0],e).then((function(t){O(Object(E.a)(Object(E.a)({},f),{},{thumbnail:t.large})),F.updateDraft(f,e)}))}},accept:"image/png, image/jpg, image/jpeg, image/gif, image/webp, image/bmp",hidden:!0}),Object(h.jsx)("div",{className:tt.a.NewPoemImageSelector,onClick:function(){return P.current.click()},style:{backgroundImage:"url(".concat(f.thumbnail,")")},children:Object(h.jsx)(u.a,{name:"add-sharp"})})]}),Object(h.jsxs)("div",{className:tt.a.NewPoemDetails,children:[Object(h.jsx)("textarea",{className:tt.a.NewPoemTitle,autoFocus:!0,name:"title",rows:f.title.split("\n").length,value:f.title,ref:_,onChange:g,placeholder:"Poem title"}),Object(h.jsxs)("span",{children:["Currently syncing edits to"," ",Object(h.jsxs)("a",{href:"/your_drafts",target:"_blank",referrerPolicy:"no-referrer",children:["Draft (",f.did,")"]}),"."]}),Object(h.jsx)("table",{className:tt.a.PoemMetadataItems,children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Written by"}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"link",onClick:function(){return O(Object(E.a)(Object(E.a)({},f),{},{is_anonymous:!f.is_anonymous}))},children:f.is_anonymous?"Anonymous":"Yourself"})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Features"}),Object(h.jsx)("td",{children:Object(h.jsx)(b.b,{children:"Add a rebbel"})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Created on"}),Object(h.jsx)("td",{children:Object(h.jsx)(b.b,{children:f.time_created})})]})]})}),Object(h.jsx)("br",{}),Object(h.jsxs)("div",{className:"flex",children:[Object(h.jsx)("button",{onClick:function(){t(!0),F.updateDraft(f,e).then((function(){n("Draft saved."),t(!1)})).catch((function(){return t(!1)}))},children:"Save Draft"}),Object(h.jsx)("button",{className:"outline",onClick:function(){t(!0),F.updateDraft(f,e).then((function(){t(!1),c(!0)})).catch((function(e){console.log("Error something went wrong."),t(!1)}))},children:"Preview and Publish"})]})]})]}),Object(h.jsx)("div",{className:tt.a.NewPoemContentsContainer,children:Object(h.jsx)("textarea",{placeholder:"Type your poem body here...",rows:f.body.split("\n").length,name:"body",onChange:g,value:f.body})})]})};var ct=function(){var e=x().userSession;return Object(h.jsx)(a.a.Fragment,{children:Object(h.jsx)(oe,{children:Object(h.jsx)(Y,{children:Object(h.jsx)(O,{children:Object(h.jsx)(_,{children:Object(h.jsx)(J,{children:Object(h.jsx)(b.a,{children:Object(h.jsxs)($e,{children:[Object(h.jsx)(v,{}),Object(h.jsxs)(j.d,{children:[Object(h.jsx)(j.b,{path:"/new_poem",children:Object(h.jsx)(it,{userSession:e})}),Object(h.jsx)(j.b,{exact:!0,path:"/",children:Object(h.jsx)(j.a,{to:"/discover"})}),Object(h.jsx)(j.b,{path:"/discover",children:Object(h.jsx)(se,{})}),Object(h.jsx)(j.b,{exact:!0,path:"/rebbels",children:Object(h.jsx)(fe,{})}),Object(h.jsx)(j.b,{path:"/rebbels/@:poet",children:Object(h.jsx)(pe,{})}),Object(h.jsx)(j.b,{path:"/your_drafts",children:Object(h.jsx)(Je,{})}),Object(h.jsx)(j.b,{path:"/feeling_lucky",children:Object(h.jsx)(Xe,{})}),Object(h.jsx)(j.b,{path:"/poem/:poemId",children:Object(h.jsx)(He,{})}),Object(h.jsx)(j.b,{path:"/search",children:Object(h.jsx)(Me,{})}),Object(h.jsx)(j.b,{path:"/sign_up",children:Object(h.jsx)(Qe,{})}),Object(h.jsx)(j.b,{path:"/sign_in",children:Object(h.jsx)(Ze,{})}),Object(h.jsx)(j.b,{path:"*",children:Object(h.jsx)(re,{})})]}),Object(h.jsx)(Ye,{})]})})})})})})})})},rt=(n(160),function(e){e&&e instanceof Function&&Promise.resolve().then(n.bind(null,160)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),o(e),a(e),s(e),i(e)}))});i.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(ct,{})}),document.getElementById("root")),rt()},18:function(e,t,n){e.exports={PoemPageHeader:"PoemPageHeader_PoemPageHeader__1YcZt",BackgroundDiffuser:"PoemPageHeader_BackgroundDiffuser__1lEzy",PoemInformationContainer:"PoemPageHeader_PoemInformationContainer__2l3Cz",PoemThumbnailImage:"PoemPageHeader_PoemThumbnailImage__ne5WI",PoemDetailsContainer:"PoemPageHeader_PoemDetailsContainer__10FpI",PoemTitle:"PoemPageHeader_PoemTitle__29a6A",PoemDescription:"PoemPageHeader_PoemDescription__1S9Wg",PoemMetadataItems:"PoemPageHeader_PoemMetadataItems__1Vaym"}},19:function(e,t,n){e.exports={Comment:"Comment_Comment__3FepX",CommentBody:"Comment_CommentBody__25PvU",Like:"Comment_Like__3O-MK",Flag:"Comment_Flag__3jENy",CommentorNameDate:"Comment_CommentorNameDate__16FBL",CommentActions:"Comment_CommentActions__331Ow",CommentActionButtons:"Comment_CommentActionButtons__1ajaQ",CommentMoreActions:"Comment_CommentMoreActions__1c0ex"}},20:function(e,t,n){e.exports={NewPoemHeaderContainer:"NewPoem_NewPoemHeaderContainer__t4L9L",link:"NewPoem_link__1Bamm",NewPoemImageSelector:"NewPoem_NewPoemImageSelector__2Gq2Z",NewPoemDetails:"NewPoem_NewPoemDetails__Kwqin",NewPoemTitle:"NewPoem_NewPoemTitle__pxTax",NewPoemContentsContainer:"NewPoem_NewPoemContentsContainer__1ebla"}},21:function(e,t,n){e.exports={DraftPreview:"DraftPreview_DraftPreview__yNm0A",DraftTitle:"DraftPreview_DraftTitle__3RCXC",DraftSplitSides:"DraftPreview_DraftSplitSides__1j1y-",DraftContents:"DraftPreview_DraftContents__1rRku",DraftAnnotations:"DraftPreview_DraftAnnotations__1vh4N",DraftAnnotationsText:"DraftPreview_DraftAnnotationsText__1OjU6",BottomButtons:"DraftPreview_BottomButtons__19wR1"}},23:function(e,t,n){e.exports={PoemInputContainer:"PoemPostInput_PoemInputContainer__1qw88",PoemInputTitle:"PoemPostInput_PoemInputTitle__2oLmn",PoemInput:"PoemPostInput_PoemInput__3YoN7",PoemTagsInput:"PoemPostInput_PoemTagsInput__26EWh",Buttons:"PoemPostInput_Buttons__3AFZM"}},24:function(e,t,n){e.exports={Poem:"Poem_Poem__LY0gH",PoemThumbnail:"Poem_PoemThumbnail__3QKkQ",PoemReadTime:"Poem_PoemReadTime__1_-w2",PoemTitle:"Poem_PoemTitle__12qQa",PoemDetails:"Poem_PoemDetails__1eZXX",PoemAuthorTime:"Poem_PoemAuthorTime__2LJYF",PoemDescription:"Poem_PoemDescription__30-xA"}},28:function(e,t,n){e.exports={PageTitle:"SearchPage_PageTitle__3czwG",SearchInputContainer:"SearchPage_SearchInputContainer__1ixej",LargeSearchInput:"SearchPage_LargeSearchInput__2nEZh",SearchButton:"SearchPage_SearchButton__3x0_t",Rebbels:"SearchPage_Rebbels__2r-5-"}},31:function(e,t,n){e.exports={flex:"Header_flex__1xcfe","space-between":"Header_space-between__u85w8","flex-space":"Header_flex-space__ye-2W",clickable:"Header_clickable__191kM",Banner:"Header_Banner__1GWR_",HeaderContainer:"Header_HeaderContainer__F-Ur3",Header:"Header_Header__2C_Ub",HeaderBrandLogo:"Header_HeaderBrandLogo__2PZZA"}},32:function(e,t,n){e.exports={Loader:"Loader_Loader__3w7V8",FirstCircle:"Loader_FirstCircle__1fzNt",FirstCircleBlink:"Loader_FirstCircleBlink__1qLd-",SecondCircle:"Loader_SecondCircle__YfdMW",SecondCircleBlink:"Loader_SecondCircleBlink__1a2nU",BlendGroup:"Loader_BlendGroup__1AEZI"}},35:function(e,t,n){e.exports={Poet:"Poet_Poet__1iqH7",PoetAvatar:"Poet_PoetAvatar__Qvcdq",PoetName:"Poet_PoetName__1MMec"}},36:function(e,t,n){e.exports={PoemShareContents:"PoemShareContents_PoemShareContents__20LFa",ShareLinkInput:"PoemShareContents_ShareLinkInput__1sKku",SocialMediaShare:"PoemShareContents_SocialMediaShare__7pT3x"}},48:function(e,t,n){e.exports={Toast:"Toast_Toast__1az6l",CloseButton:"Toast_CloseButton__Gj3ID"}},49:function(e,t,n){e.exports={CommentsSection:"CommentsSection_CommentsSection__387ir",PostCommentField:"CommentsSection_PostCommentField__3F0OP"}},69:function(e,t,n){e.exports={PoemsGrid:"PoemsList_PoemsGrid__DvbAG"}},70:function(e,t,n){e.exports={NotFoundPage:"NotFoundPage_NotFoundPage__2pL1I"}},71:function(e,t,n){e.exports={Poets:"PoetsPage_Poets__39bvA"}},72:function(e,t,n){},79:function(e,t,n){}},[[161,1,2]]]);
//# sourceMappingURL=main.6da13be6.chunk.js.map